<openerp>
  <data>

    <!-- frontend assets -->
    <template id="assets_frontend" inherit_id="website.assets_frontend" name="Groupme">
      <xpath expr="." position="inside">
        <link type="text/less" href="/groupme/static/src/less/groupme.less" rel="stylesheet" t-ignore="true"/>
        <link rel="stylesheet" href="/web/static/lib/select2/select2.css"/>
        <link rel="stylesheet" href="/website/static/lib/select2-bootstrap-css/select2-bootstrap.css"/>
        <script type="text/javascript" src="/web/static/lib/select2/select2.js"></script>
        <!-- Calculating time ( ** time ago) -->
        <script type="text/javascript" src="/groupme/static/src/js/groupme_network.js"></script>
        <!-- Create Network (Manage Category, Tags)-->
        <script type="text/javascript" src="/groupme/static/src/js/groupme_network_new.js"></script>
      </xpath>
    </template>

    <!-- header for the network list and category -->
    <template id="networksheader">
      <section class="jumbotron s_button mb16">
        <div class="container">
          <div class="row">
            <div class="col-md-8 col-xs-8">
              <p class="mb0">
                <strong class="o_default_snippet_text">Thousands of people use Groupme.in</strong>
              </p>
              <p class="mb0 o_default_snippet_text text-muted">
                Create a free group for family, friends, business, clubs, schools and colleges.
              </p>
            </div>
          </div>
        </div>
      </section>
    </template>

    <!-- display list of groups -->
    <template id="category">
      <t t-call="website.layout">
        <!-- <t t-call="groupme.newmodal"/> -->
        <t t-call="groupme.networksheader"/>

        <div class="container">
          <div class="row">
            <div class="mt16">
              <div t-foreach="networks" t-as="network" class="col-sm-3 col-md-3">
                <t t-call="groupme.network-item"/>
              </div>
            </div>
          </div>
        </div>
        <div class="oe_structure"/>
      </t>
    </template>

    <!-- display list of groups -->
    <template id="networks">
      <t t-call="website.layout">
        <t t-call="groupme.networksheader"/>
        <div class="container">
          <div class="row" style="border-bottom: 1px solid #eee;padding-bottom: 15px;">
            <div class="col-md-8">
<!--               <button type="button" class="btn btn-default" aria-label="Left Align">
                <i class="fa fa-university"></i> Clubs
              </button>
              <button type="button" class="btn btn-default" aria-label="Left Align">
                <i class="fa fa-building-o"></i> Schools &amp; Colleges
              </button>
              <button type="button" class="btn btn-default" aria-label="Left Align">
                <i class="fa fa-suitcase"></i> Business
              </button> -->
              <t t-call="website.pager" style="margin: auto;"/>
              <!-- <span style="font-size: x-large;">500 groups, 5000 users, 200K messages</span> -->
            </div>
            <div class="col-md-4">
              <form method="get" action="/networks">
                <div class="input-group">
                  <input type="search" class="form-control" name="search" t-attf-placeholder="Search for groups" t-att-value="search"/>
                  <span class="input-group-btn">
                    <a class="btn btn-danger" href="/networks" t-if="search">
                      <i class="fa fa-times"></i>
                    </a>

                    <button class="btn btn-primary" type="submit">
                      <i class="fa fa-search"></i>
                    </button>
                    <a class="btn btn-success oe_js_network_new" title="Create Group" t-if="not is_public_user">
                      <i class="fa fa-plus"></i> Create
                    </a>
                  </span>
                </div>
              </form>
            </div>
          </div>
          
          <div class="row">
            <div class="mt16">
              <div t-foreach="networks" t-as="network" class="col-sm-3 col-md-3">
                <t t-call="groupme.network-item"/>
              </div>
            </div>
          </div>
        </div>
        <div class="oe_structure"/>
      </t>
    </template>

    <!-- group detail on list view -->
    <template id="network-item">
      <div class="thumbnail">
        <a t-attf-href="/networks/network/#{network.id}">
          <div class="group-image" t-attf-style="background: url('/website/image/groupme.network/#{network.id}/image_thumb');">
            <!-- <img t-attf-src="/website/image/groupme.network/#{network.id}/image_thumb" t-att-alt="network.name" class="img img-responsive" style="width:100%;"/> -->
          </div>
        </a>
        <div class="caption">
          <h3 style="margin-top: 5px;"><span t-field="network.name"/></h3>
          <p class="text-muted clearfix">
            <small class="pull-left"><span t-esc="len(network.message_follower_ids)"/> members</small>
            <small class="pull-right"><timeago class="timeago" t-att-datetime="network.create_date"></timeago></small>
          </p>
          <p class="text-muted clearfix">
            <i t-attf-class="fa #{network.category_id.icon} text-muted"></i> 
            <a t-attf-href="/networks/category/#{network.category_id.id}">
              <span t-esc="network.category_id.name"/>
            </a>
          </p>
          <p t-if="network.tag_ids">
            <i class="fa fa-tags text-muted"></i>
            <t t-foreach="network.tag_ids" t-as="tag">
              <a t-attf-href="networks/tag/#{slug(tag)}">
                <span t-attf-class="label label-default #{tag and tag.name == tag.name and 'label-primary' ''} text-muted" t-field="tag.name"/>
              </a>
            </t>
          </p>
        </div>
      </div>
    </template>

    <!-- user card -->
    <template id="user_card">
      <div class="row well" style="padding: 5px;margin-right: 1px;">
        <div class="col-xs-3" style="height:60px;width:60px;padding: 0px;overflow: hidden;">
          <img class="img img-avatar" t-attf-src="/website/image/res.partner/#{user.id}/image" style="padding: 0px;width:100%"/>
        </div>
        <div class="col-xs-9">
          <i class="fa fa-circle text-success"></i> <a a-attf-href="/networks/user/#{user.id}"><span t-field="user.name"/></a>
          <span src="/website/image/res.partner/#{user.id}/image"></span>
          <div>
            <small t-field="user.email" class="text-muted"/>
          </div>
          <div>
            <!-- <i t-attf-class="fa fa-circle #{user.state == 'active' and 'text-success' 'text-danger'}"></i> Active -->
             <small class="text-muted">Last seen, 20 minutes ago</small>
          </div>
        </div>
      </div>
    </template>

    <!-- group page view -->
    <template id="network_view">
      <t t-call="website.layout">
        <t t-call="groupme.networksheader"/>
        <div class="container">
            <div class="col-md-3 pl0">
              <div class="group-image">
                <span itemprop="image" t-field="network.image" t-field-options='{"widget": "image", "class": "img img-responsive img-rounded"}' style="width:100%"/>
              </div>
              <small class="text-muted" t-if="not is_public_user">Required image resolution is 250px X 200px</small>

              <h3><span t-field="network.name"/></h3>
              <p style="border-bottom: 1px solid #eee;padding-bottom: 5px;">
                <code><span t-esc="network.code"/> </code>
                <button class="btn btn-success btn-xs pull-right" type="button" t-if="network.visibility!='private'">Join Group</button>
              </p>
              <p t-if="network.visibility=='private'">
                <i class="fa fa-lock text-muted"></i> Private Group
              </p>
              <!-- <p><i class="fa fa-user text-muted"></i> <span t-esc="network.sudo().author_id.name"/>, is group owner</p> -->
              <p><i class="fa fa-map-marker text-muted"></i> <span t-field="network.location"/></p>
              <p><i class="fa fa-globe text-muted"></i> <a t-attf-href="network.sudo().author_id.website" target="_new"><span t-field="network.sudo().author_id.website"/></a></p>
              <p><i class="fa fa-clock-o text-muted"></i> <timeago class="timeago" t-att-datetime="network.create_date"/></p>
              <p><i class="fa fa-users text-muted"></i> <span t-esc="len(network.sudo().message_follower_ids)"/> members</p>
              <p style="border-bottom: 1px solid #eee;padding-bottom: 5px;"><i class="fa fa-comments-o text-muted"></i> <span t-esc="network.message_per_day"/> message / day</p>
              <p><i t-attf-class="fa #{network.category_id.icon} text-muted"></i> <span t-esc="network.category_id.name"/></p>
              <p t-if="network.tag_ids">
                <i class="fa fa-tags text-muted"></i>
                <t t-foreach="network.tag_ids" t-as="tag">
                  <a t-attf-href="networks/tag/#{slug(tag)}">
                    <span t-attf-class="label label-default #{tag and tag.name == tag.name and 'label-primary' ''} text-muted" t-field="tag.name"/>
                  </a>
                </t>
              </p>
            </div>

            <div class="col-md-9 pr0" t-if="is_public_user">
              <div t-field="network.description" />
            </div>

            <div class="col-md-9" t-if="not is_public_user">
              <ul class="nav nav-tabs">
                <li role="presentation" class="active">
                  <a href="#about" role="tab" data-toggle="tab">
                    <i class="fa fa-home"></i> About
                  </a>
                </li>
                <li role="presentation">
                  <a href="#members" role="tab" data-toggle="tab">
                    <i class="fa fa-users"></i> Members
                  </a>
                </li>
                <li role="presentation">
                  <a href="#messages" role="tab" data-toggle="tab">
                    <i class="fa fa-comments-o"></i> Messages
                  </a>
                </li>

                <li role="presentation" class="pull-right" t-if="not is_public_user">
                  <div>
                    <button type="submit" class="btn btn-default"> <i class="fa fa-pencil"></i> Edit Group</button>
                    &amp;nbsp;
                    <t t-call="website.publish_management">
                      <t t-set="object" t-value="network"/>
                      <t t-set="publish_edit" t-value="False"/>
                    </t>
                  </div>
                </li>
              </ul>

              <div class="tab-content" style="padding-top:8px;">
                <div class="active tab-pane" id="about">
                  <div t-field="network.description" />
                </div>

                <div class="tab-pane" id="members">
                  <div class="row mb16">
                    <div class="col-md-6">

                    </div>
                    <div class="col-md-6">
                      <form method="get" action="/networks">
                        <div class="input-group">
                          <input type="search" class="form-control" name="search" t-attf-placeholder="Search for members" t-att-value="search"/>
                          <span class="input-group-btn">
                            <a class="btn btn-danger" href="/networks" t-if="search">
                              <i class="fa fa-times"></i>
                            </a>

                            <button class="btn btn-primary" type="submit">
                              <i class="fa fa-search"></i>
                            </button>
                            <a class="btn btn-success oe_js_network_new" title="Invite Members">
                              <i class="fa fa-plus"></i> Invite
                            </a>
                          </span>
                        </div>
                      </form>
                    </div>
                  </div>

                  <div class="col-xs-4" t-foreach="network.sudo().message_follower_ids" t-as="user">
                    <t t-call="groupme.user_card"/>
                  </div>
                </div>

                <div class="tab-pane" id="messages">
                  <div class="alert alert-danger alert-dismissable mb16" t-if="not network.view_message">
                    <p>
                      We do not store any message sent by you or any of your group members in our system, without your permission <a href="#">click here</a> to enable to track all message sent in this group
                    </p>
                  </div>
                  <div class="alert alert-success alert-dismissable mb16" t-if="network.view_message">
                    <p>
                      We do not store any message sent by you or any of your group members in our system, without your permission <a href="#">click here</a> to enable to track all message sent in this group
                    </p>
                  </div>

                  <div class="mb16">
                    <form id="comment" t-attf-action="/networks/network/#{network.id}/comment" method="POST" t-if="network.website_published">
                      <div class="media">
                        <span class="pull-left">
                          <img class="img img-circle media-object"
                            t-attf-src="/website/image/res.partner/#{user_id.partner_id.id}/image"
                            style="width: 30px"/>
                        </span>
                        <div class="media-body">
                            <textarea rows="3" name="comment" class="form-control" placeholder="Write a message to broadcast to this group..."></textarea>
                            <p class="text-muted">
                              <small>
                              You can send upto 200 charactor only.
                              </small>
                            </p>
                          <div class="input-group">
                            <span class="input-group-addon"><i class="fa fa-link"></i></span>
                            <input type="text" name="link" class="form-control" aria-label="Amount (to the nearest dollar)"></input>
                          </div>
                          <button type="submit" class="btn btn-primary mt8">Send Message</button>
                        </div>
                      </div>
                    </form>
                  </div>
                  <div class="oe_network_messages mt16" t-if="comments">
                    <h4 class="text-muted" style="border-bottom: 1px solid #ccc;padding-bottom: 5px;"><span t-esc="len(comments)"/> Messages sent</h4>

                    <ul class="media-list mt8">
                      <li t-foreach="comments" t-as="message" class="media">
                        <span class="pull-left">
                          <img class="media-object img img-circle"
                            t-att-src="'/website/image?model=mail.message&amp;field=author_avatar&amp;id='+str(message.id)" style="width: 30px"/>
                        </span>
                        <div class="media-body">
                          <span t-field="message.author_id" style="display: inline-block;" t-field-options='{"widget": "contact", "fields": ["name"]}'/>
                          <span class="text-muted"> on <span t-field="message.date"/></span>
                          <div t-field="message.body" class="discussion_scroll_post"></div>
                        </div>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
        </div>
      </t>
    </template>
  </data>
</openerp>